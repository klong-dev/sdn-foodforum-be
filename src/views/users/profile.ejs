<div class="container my-5">
    <div class="row">
        <!-- Left Sidebar with User Info -->
        <div class="col-lg-4 mb-4">
            <div class="card">
                <div class="card-body text-center">
                    <% if (user.avatar) { %>
                        <img src="<%= user.avatar %>" alt="<%= user.username %>" class="rounded-circle img-fluid mb-3"
                            style="width: 150px; height: 150px; object-fit: cover;">
                        <% } else { %>
                            <div class="rounded-circle bg-primary d-flex align-items-center justify-content-center mx-auto mb-3"
                                style="width: 150px; height: 150px;">
                                <span class="display-4 text-white">
                                    <%= user.username.charAt(0).toUpperCase() %>
                                </span>
                            </div>
                            <% } %>
                                <h3 class="mb-1">
                                    <%= user.username %>
                                </h3>
                                <p class="text-muted small">Member since <%= new
                                        Date(user.createdAt).toLocaleDateString('en-US', { year: 'numeric' ,
                                        month: 'long' , day: 'numeric' }) %>
                                </p>

                                <div class="d-flex justify-content-around mb-4">
                                    <div class="text-center">
                                        <h5>
                                            <%= userStats.recipes || 0 %>
                                        </h5>
                                        <small class="text-muted">Recipes</small>
                                    </div>
                                    <div class="text-center">
                                        <h5>
                                            <%= userStats.posts || 0 %>
                                        </h5>
                                        <small class="text-muted">Posts</small>
                                    </div>
                                    <div class="text-center">
                                        <h5>
                                            <%= userStats.comments || 0 %>
                                        </h5>
                                        <small class="text-muted">Comments</small>
                                    </div>
                                </div>

                                <% if (isOwnProfile) { %>
                                    <a href="/users/edit-profile" class="btn btn-outline-primary btn-sm d-block"><i
                                            class="bi bi-pencil-square"></i> Edit Profile</a>
                                    <% } else { %>
                                        <button class="btn btn-outline-primary btn-sm d-block w-100"><i
                                                class="bi bi-person-plus"></i> Follow</button>
                                        <% } %>
                </div>

                <ul class="list-group list-group-flush">
                    <% if (user.location) { %>
                        <li class="list-group-item d-flex align-items-center">
                            <i class="bi bi-geo-alt me-3"></i>
                            <span>
                                <%= user.location %>
                            </span>
                        </li>
                        <% } %>
                            <% if (user.website) { %>
                                <li class="list-group-item d-flex align-items-center">
                                    <i class="bi bi-link-45deg me-3"></i>
                                    <a href="<%= user.website %>" target="_blank">
                                        <%= user.website.replace(/^https?:\/\//, '' ) %>
                                    </a>
                                </li>
                                <% } %>
                                    <li class="list-group-item d-flex align-items-center">
                                        <i class="bi bi-envelope me-3"></i>
                                        <span>
                                            <%= user.email %>
                                        </span>
                                    </li>
                </ul>

                <% if (user.bio) { %>
                    <div class="card-body">
                        <h6 class="card-title">About</h6>
                        <p class="card-text">
                            <%= user.bio %>
                        </p>
                    </div>
                    <% } %>
            </div>

            <div class="card mt-4">
                <div class="card-header">
                    <h5 class="card-title mb-0">Interests</h5>
                </div>
                <div class="card-body">
                    <div class="d-flex flex-wrap gap-2">
                        <% const interests=user.interests || ['Italian', 'Desserts' , 'Vegan' , 'Quick Meals' ]; %>
                            <% interests.forEach(interest=> { %>
                                <span class="badge bg-light text-dark">
                                    <%= interest %>
                                </span>
                                <% }); %>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Content Area -->
        <div class="col-lg-8">
            <!-- Tab navigation -->
            <ul class="nav nav-tabs mb-4" id="profileTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="recipes-tab" data-bs-toggle="tab" data-bs-target="#recipes"
                        type="button" role="tab" aria-controls="recipes" aria-selected="true">Recipes</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="posts-tab" data-bs-toggle="tab" data-bs-target="#posts" type="button"
                        role="tab" aria-controls="posts" aria-selected="false">Posts</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="comments-tab" data-bs-toggle="tab" data-bs-target="#comments"
                        type="button" role="tab" aria-controls="comments" aria-selected="false">Comments</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="saved-tab" data-bs-toggle="tab" data-bs-target="#saved" type="button"
                        role="tab" aria-controls="saved" aria-selected="false">Saved</button>
                </li>
            </ul>

            <!-- Tab content -->
            <div class="tab-content" id="profileTabContent">
                <!-- Recipes Tab -->
                <div class="tab-pane fade show active" id="recipes" role="tabpanel" aria-labelledby="recipes-tab">
                    <% if (userContent.recipes && userContent.recipes.length> 0) { %>
                        <div class="row row-cols-1 row-cols-md-2 g-4">
                            <% userContent.recipes.forEach(recipe=> { %>
                                <div class="col">
                                    <div class="card h-100 recipe-card">
                                        <img src="<%= recipe.image %>" class="card-img-top" alt="<%= recipe.title %>"
                                            style="height: 180px; object-fit: cover;">
                                        <div class="card-body">
                                            <div class="d-flex justify-content-between mb-2">
                                                <span class="text-muted small"><i class="bi bi-clock"></i>
                                                    <%= recipe.time %>
                                                </span>
                                                <span class="text-muted small"><i
                                                        class="bi bi-star-fill text-warning"></i>
                                                    <%= recipe.rating %>
                                                </span>
                                            </div>
                                            <h5 class="card-title">
                                                <%= recipe.title %>
                                            </h5>
                                            <p class="card-text small">
                                                <%= recipe.description %>
                                            </p>
                                            <div class="d-flex justify-content-between align-items-center">
                                                <a href="/recipes/<%= recipe.id %>"
                                                    class="btn btn-sm btn-outline-primary">View Recipe</a>
                                                <small class="text-muted">
                                                    <%= recipe.views %> views
                                                </small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <% }); %>
                        </div>
                        <% } else { %>
                            <div class="text-center py-5">
                                <i class="bi bi-journal-richtext" style="font-size: 3rem;"></i>
                                <h4 class="mt-3">No recipes yet</h4>
                                <p class="text-muted">This user hasn't shared any recipes.</p>
                                <% if (isOwnProfile) { %>
                                    <a href="/recipes/create" class="btn btn-primary mt-2">Share a Recipe</a>
                                    <% } %>
                            </div>
                            <% } %>
                </div>

                <!-- Posts Tab -->
                <div class="tab-pane fade" id="posts" role="tabpanel" aria-labelledby="posts-tab">
                    <% if (userContent.posts && userContent.posts.length> 0) { %>
                        <div class="list-group">
                            <% userContent.posts.forEach(post=> { %>
                                <a href="/forum/post/<%= post.id %>" class="list-group-item list-group-item-action">
                                    <div class="d-flex w-100 justify-content-between">
                                        <h5 class="mb-1">
                                            <%= post.title %>
                                        </h5>
                                        <small class="text-muted">
                                            <%= post.postedAt %>
                                        </small>
                                    </div>
                                    <p class="mb-1">
                                        <%= post.content %>
                                    </p>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <small class="text-muted">In <%= post.category %></small>
                                        <span><i class="bi bi-chat-left-text me-1"></i>
                                            <%= post.replies %> replies
                                        </span>
                                    </div>
                                </a>
                                <% }); %>
                        </div>
                        <% } else { %>
                            <div class="text-center py-5">
                                <i class="bi bi-chat-square-text" style="font-size: 3rem;"></i>
                                <h4 class="mt-3">No forum posts yet</h4>
                                <p class="text-muted">This user hasn't created any forum posts.</p>
                                <% if (isOwnProfile) { %>
                                    <a href="/forum/new" class="btn btn-primary mt-2">Start a Discussion</a>
                                    <% } %>
                            </div>
                            <% } %>
                </div>

                <!-- Comments Tab -->
                <div class="tab-pane fade" id="comments" role="tabpanel" aria-labelledby="comments-tab">
                    <% if (userContent.comments && userContent.comments.length> 0) { %>
                        <div class="list-group">
                            <% userContent.comments.forEach(comment=> { %>
                                <div class="list-group-item">
                                    <div class="d-flex justify-content-between mb-2">
                                        <a href="/recipes/<%= comment.postId %>" class="text-decoration-none">
                                            <strong>
                                                <%= comment.postTitle %>
                                            </strong>
                                        </a>
                                        <small class="text-muted">
                                            <%= comment.postedAt %>
                                        </small>
                                    </div>
                                    <p class="mb-0">
                                        <%= comment.content %>
                                    </p>
                                </div>
                                <% }); %>
                        </div>
                        <% } else { %>
                            <div class="text-center py-5">
                                <i class="bi bi-chat-left" style="font-size: 3rem;"></i>
                                <h4 class="mt-3">No comments yet</h4>
                                <p class="text-muted">This user hasn't left any comments.</p>
                            </div>
                            <% } %>
                </div>

                <!-- Saved Tab (only visible for own profile) -->
                <div class="tab-pane fade" id="saved" role="tabpanel" aria-labelledby="saved-tab">
                    <% if (!isOwnProfile) { %>
                        <div class="text-center py-5">
                            <i class="bi bi-lock" style="font-size: 3rem;"></i>
                            <h4 class="mt-3">Private Content</h4>
                            <p class="text-muted">Saved items are only visible to the account owner.</p>
                        </div>
                        <% } else if (userContent.saved && userContent.saved.length> 0) { %>
                            <div class="row row-cols-1 row-cols-md-2 g-4">
                                <% userContent.saved.forEach(item=> { %>
                                    <div class="col">
                                        <div class="card h-100">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between">
                                                    <h5 class="card-title">
                                                        <%= item.title %>
                                                    </h5>
                                                    <span class="badge bg-secondary">
                                                        <%= item.type %>
                                                    </span>
                                                </div>
                                                <p class="card-text small">
                                                    <%= item.description %>
                                                </p>
                                                <a href="<%= item.url %>"
                                                    class="btn btn-sm btn-outline-primary">View</a>
                                            </div>
                                        </div>
                                    </div>
                                    <% }); %>
                            </div>
                            <% } else { %>
                                <div class="text-center py-5">
                                    <i class="bi bi-bookmark" style="font-size: 3rem;"></i>
                                    <h4 class="mt-3">No saved items</h4>
                                    <p class="text-muted">You haven't saved any recipes or posts yet.</p>
                                    <a href="/recipes" class="btn btn-primary mt-2">Explore Recipes</a>
                                </div>
                                <% } %>
                </div>
            </div>
        </div>
    </div>
</div>